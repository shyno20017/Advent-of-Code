// Advent of Code Day 19

let input = `
                                                                                                                                                                   |
                       +---------------------------------------------------------------------------+             +---------------------+             +---+       +-------------------------------------+
                       |                                                                           |             |                     |             |   |       | |                                   |
                     +---------------+                     +---------------+               +-------|-------------------------------------+           |   |       | |         +-----------+       +-----+
                     | |             |                     |               |               |       |             |                     | |           |   |       | |         |           |       |
         +---+       | | +-------+   |                     | +-----------------------------|-------------------------------------------|-----------+ |   |       | |         |           | +-----------+
         |   |       | | |       |   |                     | |             |               |       |             |                     | |         | |   |       | |         |           | |     |     |
 +-----------+       | +-|-----------|-----------+         | +---+         |               |       |           +-----------------------|-|---------------|-------|-----------|-----------------------+ |
 |       |           |   |       |   |           |         |     |         |               |       |           | |                     | |         | M   |       | |         |           | |     |   | |
 |       |           | +-|-----------|---------------------|-----+         |               |       |           | |           +---------+ +-+     +---------------|-----------|---------------+   | +-+ |
 |       |           | | |       |   |           |         |               |               |       |           | |           |             |     | | |   |       | |         |           | | |   | |   |
 |       |           | | |       +-------------------------|---------------|---------------|-------|-------+   | |     +-----+         +-----+   | | |   |       | |         | +---+ +-+ | | |   | |   |
 |       |           | | |           |           |         |               |               |       |       |   | |     |               |   | |   | | |   |       | |         | |   | | | | | |   | |   |
 |       |           +---|-+         |   +---+   |         +---------------------------------------|-------------|---------------------------|-----|-|---|-------|---------------------|-|-|---------+ |
 |       |             | | |         |   |   |   |                         |               |       |       |   | |     |               |   | |   | | |   |       | |         | |   | | | | | |   | | | |
 |       |   +---+     | | |         |   |   |   |                         |       +-------|-------|-------|---|-|-----|---------------|-----------|-------------|-|-----------|---|-|-|-|---+   | | | |
 |       |   |   |     | | |         |   |   |   |                         |       |       |       |       |   | |     |               |   | |   | | |   |       | |         | |   | | | | |     | | | |
 |       |   |   |     | | |         |   |   |   |                         |       +-----------------------------|---------------------|---|-|-------------------|-|-----------|---|-|-|-|-------|-|---+
 |       |   |   |     C | |         |   |   |   |                         |               |       |       |   | |     |               |   | |   | | |   |       | |         | |   | | | | |     | | |
 |       | +-|---|-----|-|-----------|-------|-----------------------------|-------------+ |       |       |   | |     |     +-------------|-|---|-|-|---|---+   | |         | |   | | | | |     | | |
 |       | | |   |     | | |         |   |   |   |                         |             | |       |       |   | |     |     |         |   | |   | | |   |   |   | |         | |   | | | | |     | | |
 |       | +-|---|-----|-------------|-------|-----------------------------|---------------|-------------------|-------|-----|---------|---|-+   | | |   |   |   | |         | | +-|---|---|-----|-+ |
 |       |   |   |     | | |         |   |   |   |                         |             | |       |       |   | |     |     |         |   |     | | |   |   |   | |         | | | | | | | |     |   |
 | +---+ |   |   |     | | |         |   | +-+   |                   +---------------------|---+   |       |   | |     |     |         | +-|-----|-|-------------|-----------+ | | | | | | |     | +---+
 | |   | |   |   |     | | |         |   | |     |                   |     |             | |   |   |       |   | |     |     |         | | |     | | |   |   |   | |           | | | | | | |     | | P |
 | |   | |   |   |     | | |         |   | |     |           +-+     |     |             | |   |   |       |   | |     |     |         | | |     | | |   |   |   | |           | | | | | | |     | | | |
 | |   | |   |   |     | | |         |   | |     |           | |     |     |             | |   |   |       |   | |     |     |         | | |     | | |   |   |   | |           | | | | | | |     | | | |
 | |   | |   |   | +---|-+ |         +---|-|-----|-----------|-+     |     |             | |   |   |       |   | |     |     |         | | |     | | |   |   |   | |           | | | | | | |     | | | |
 | |   | |   |   | |   |   |             | |     |           |       |     |             | |   |   |       |   | |     |     |         | | |     | | |   |   |   | |           | | | | | | |     | | | |
 | |   | |   |   | |   |   |             | |     |           |       |     |             | |   |   |       |   | |     | +---|---------+ | | +---|-|-|---|---------|-----------|-+ +-+ | | |     | | | |
 | |   | |   |   | |   |   |             | |     |           |       |     |             | |   |   |       |   | |     | |   |           | | |   | | |   |   |   | |           |       | | |     | | | |
 | |   | |   |   | |   |   |             | |     |           |       |     |             | |   |   |       |   | |     | |   +-------+   | | |   | | |   |   |   | |         +-------+ | | |     | | | |
 | |   | |   |   | |   |   |             | |     |           |       |     |             | |   |   |       |   | |     | |           |   | | |   | | |   |   |   | |         | |     | | | |     | | | |
 | | +---|---|---|---------|-----+ +-----|-|-----|-------------------|-----|-------------|-|-------|-----------|-|-----|-------------------|-------|---------|---|-----------|-----------+ |     | | | |
 | | | | |   |   | |   |   |     | |     | |     |           |       |     |             | |   |   |       |   | |     | |           |   | | |   | | |   |   |   | |         | |     | |   |     | | | |
 | | | | |   |   | |   |   |     | |     | |     |           |       |     |             | |   |   |       |   | |     | |           |   | | |   | | |   |   |   | |         | |     | | +-------+ | | |
 | | | | |   |   | |   |   |     | |     | |     |           |       |     |             | |   |   |       |   | |     | |           |   | | |   | | |   |   |   | |         | |     | | | |       | | |
 | | | | |   |   | |   |   |     | |     | | +---+           |       |     |             | |   |   |       |   | |     | |           |   | | |   | | |   |   |   | |       +-|-+ Y +-|-|-----+     | | |
 | | | | |   |   | |   |   |     | |     | | |               |       |     |             | |   |   |       |   | |     | |           |   | | |   | | |   |   |   | |       | |   | | | | | | |     | | |
 | | | | |   |   | |   |   |     | |     | | |               |       |     |             | |   |   |       |   | |     | |       +-+ |   | | |   | | |   |   |   | |       | |   | | | | | | |     | | |
 | | | | |   |   | |   |   |     | |     | | |               |       |     |             | |   |   |       |   | |     | |       | | |   | | |   | | |   |   |   | |       | |   | | | | | | |     | | |
 | | | | |   |   +-|-------|-----|-|-----|-------------------|-------------|---------------|---------------------|-----|-|---------|-|---|-|-|-------|---|-------+ |       | |   | | | | | | |     | | |
 | | | | |   |     |   |   |     | |     | | |               |       |     |             | |   |   |       |   | |     | |       | | |   | | |   | | |   |   |     |       | |   | | | | | | |     | | |
 | | | | |   |     |   |   |     | |     | | |               |       |     |       +-----|---------|-------------|---------------|---|---|-|-|-----|-+   |   |     +-------|-+   +---|---|-------+ | | |
 | | | | |   |     |   |   |     | |     | | |               |       |     |       |     | |   |   |       |   | |     | |       | | |   | | |   | |     |   |             |       | | | | | |   | | | |
 | | | | |   |     |   |   |     | |     | | |               |       |     |       |     | +-------------------|-------|-------------|---+ | |   | |     |   |             |       | | | | | |   | | | |
 | | | | |   |     |   |   |     | |     | | |               |       |     |       |     |     |   |       |   | |     | |       | | |     | |   | |     |   |             |       | | | | | |   | | | |
 | | | | |   |     |   |   |     | |     | | |               |       |   +-|-------------------|---|-----+ |   | |     | |       | | |     | |   | |     |   |             |       | | | | | |   | | | |
 | | | | |   |     |   |   |     | |     | | |               |       |   | |       |     |     |   |     | |   | |     | |       | | |     | |   | |     |   |             |       | | | | | |   | | | |
 | | | | |   |     |   |   |     | |     | | |               |       |   | |       |     |     |   |     | |   | |     | |       | | |     | |   | |     |   |             |       | | | | | |   | | | |
 | | | | |   |     |   |   |     | |     | | |               |       |   | |       |     |     |   |     | |   | |     | |       | | |     | |   | |     |   |             |       | | | | | |   | | | |
 | | | | |   |     |   |   |     | |     | | |               |       |   | | +-----|-----|---------|-------|---|-|-------------------|---------------------------------------------|-|-----|---+ | | | |
 | | | | |   |     |   |   |     | |     | | |               |       |   | | |     |     |     |   |     | |   | |     | |       | | |     | |   | |     |   |             |       | | | | | | | | | | |
 | | | | |   |     |   |   |     | |     | | |               |       |   | | |     |     |     |   |     | |   | |     | |       | | |     | |   | |   +-|-+ |             |       | | | | | | | | | | |
 | | | | |   |     |   |   |     | |     | | |               |       |   | | |     |     |     |   |     | |   | |     | |       | | |     | |   | |   | | | |             |       | | | | | | | | | | |
 | | | | |   |     |   |   |     | |     | | |               |       |   | | |     |     |     |   |     | |   | |     | |       | | |     | |   | |   | | | |             |       | | | | | | | | | | |
 | | | | |   |     |   |   |     | |     | | |               |       |   | | |     |     |     |   |     | |   | |     | |       | | |     | |   | |   | | | |             |       | | | | | | | | | | |
 | | | | |   |     |   |   |     | |     | | |               | +-----|---|-|-|-----|-----|-+   |   |     | |   | |     | |       | | |     | |   | |   | | | |             |       | | | | | | | | | | |
 | | | | |   |     |   |   |     | |     | | |               | |     |   | | |     |     | |   |   |     | |   | |     | |       | | |     | |   | |   | | | |             |       | | | | | | | | | | |
 | | | | |   |     |   |   |     | |     | | |               | |   +-------|-|-----|-----|-+   |   | +---+ |   +---------|-------|---------|-|---|-----|-|-|-+             |       | | | | | | | | | | |
 | | | | |   |     |   |   |     | |     | | |               | |   | |   | | |     |     |     |   | |     |     |     | |       | | |     | |   | |   | | |               |       | | | | | | | | | | |
 | | | | |   |     |   |   |     | |   +---|-|---------------|-|---|-|-----|-------------|-+   |   | |     +-----------|-------------|---------+ | |   | | |       +-----+ |       | | | | | | | | | | |
 | | | | |   |     |   |   |     | |   | | | |               | |   | |   | | |     |     | |   |   | |           |     | |       | | |     | | | | |   | | |       |     | |       | | | | | | | | | | |
 | | | | |   |     |   |   |     | |   | | | |               | |   | |   | | |     |     | |   |   | |   +-------|---------------------------|---|-------|---+     +-------|---+   | | | | | | | | | | |
 | | | | |   |     |   |   |     | |   | | | |               | |   | |   | | |     |     | |   |   | |   |       |     | |       | | |     | | | | |   | | | |           | |   |   | | | | | | | | | | |
 | | | | |   |     |   |   |     | |   +-+ | |               | |   | |   | | |     |     | |   |   | |   |       |     | |       | | |     | | | | |   | | | |           | |   |   | | | | | | | | | | |
 | | | | |   |     |   |   |     | |       | |               | |   | |   | | |     |     | |   |   | |   |       |     | |       | | |     | | | | |   | | | |           | |   |   | | | | | | | | | | |
 | | | | |   |     |   |   |     | |   +-----|---------------|-|-----------|-|-----|-----|-|---|---|-----------------+ | |       | | |     | | | | |   | | | |           | |   |   | | | | | | | | | | |
 | | | | |   |     |   |   |     | |   |   | |               | |   | |   | | |     |     | Q   |   | |   |       |   | | |       | | |     | | | | |   | | | |           | |   |   | | | | | | | | | | |
 | | | | |   |     |   |   |     | |   |   | |               | |   | |   | | |     |     | |   |   | |   |       |   | +-----+   | | |     | | | | |   | +-+ |           | |   |   | | | | | | | | | | |
 | | | | |   |     |   |   |     | |   |   | |               | |   | |   | | |     |     | |   |   | |   |       |   |   |   |   | | |     | | | | |   |     |           | |   |   | | | | | | | | | | |
 | | | +-----------|---|---------|-|-----------------------+ | |   | |   | | |     |     | |   |   | |   |       |   | +---------------------|-|-|-----------|----------E------+   | | | | | | | | | | |
 | | |   |   |     |   |   |     | |   |   | |             | | |   | |   | | |     |     | |   |   | |   |       |   | | |   |   | | |     | | | | |   |     |           | |       | | | | | | | | | | |
 | | |   |   |     |   |   |     | |   |   | |             | | |   | |   | | |     |     +---------|-|---|-----------|-|-|---+   | | |     | | | | |   |     |           | |       | | | | | | | | | | |
 | | |   |   |     |   |   |     | |   |   | |             | | |   | |   | | |     |       |   |   | |   |       |   | | |       | | |     | | | | |   |     |           | |       | | | | | | | | | | |
 | | |   |   |     |   |   |     | |   |   | |             | | |   | |   | | | +---|-------|---|-+ | | +-|-------------|-|-----------|-----|---|-----+ |     |           +-+       | | | | | | | | | | |
 | | |   |   |     |   |   |     | |   |   | |             | | |   | |   | | | |   |       |   | | | | | |       |   | | |       | | |     | | | | | | |     |                     | | | | | | | | | | |
 | | |   |   |     |   |   |     | |   |   | |   +-----------------|-|---|-----|-----------|---|-|---------------|-----|-------------------|-|-|-----|---------------+             | | | | | | | | | | |
 | | |   |   |     |   |   |     | |   |   | |   |         | | |   | |   | | | |   |       |   | | | | | |       |   | | |       | | |     | | | | | | |     |       |             | | | | | | | | | | |
 | | |   |   |     |   |   |     | |   |   | |   |         | | |   | |   +---|-|---|-------|---|-----|---|-----------|---------------|-----|-------|---|-----|-----------------+   | | | | | | | | | | |
 | | |   |   |     |   |   |     | |   |   | |   |         | | |   | |     | | |   |       |   | | | | | |       |   | | |       | | |     | | | | | | |     |       |         |   | | | | | | | | | | |
 | | |   |   |     |   |   |     | |   |   | |   +-------+ | | |   | |     | | |   |       |   | | | | | |       |   | | |       | | |     | | | | | | |     |       |         |   | | | | | | | | | | |
 | | |   |   |     |   |   |     | |   |   | |           | | | |   | |     | | |   |       |   | | | | | |       |   | | |       | | |     | | | | | | |     |       |         |   | | | | | | | | | | |
 | | |   |   |     |   +---------------|-+ | |         +-|-|-------------------|-----------|-----|-|-|-|---------------|-|-----------|-----|-|-|---------------------|-------------|-|-|-|-----|-|-+ | |
 | | |   |   |     |       |     | |   | | | |         | | | | |   | |     | | |   |       |   | | | | | |       |   | | |       | | |     | | | | | | |     |       |         |   | | | | | | | |   | |
 | | |   |   |   +-|---+   |     | |   | | | |         | | | | |   | |     | +-|---|-----+ |   +---|---|-|---+   |   | | +-------|-|-------|---|-|---|-------|-----+ |       +-------|-----+ | | |   | |
 | | |   |   |   | |   |   |     | |   | | | |         | | | | |   | |     |   |   |     | |     | | | | |   |   |   | |         | | |     | | | | | | |     |     | |       | |   | | | |   | | |   | |
 | | +-+ |   |   | |   |   |     | |   | | +-----------|-|-|---|---|-------|---|---|---------------|-|-|---------+   | |       +-|---|---------|-|-----------|-------|-------|-----|-----|-----|---+ | |
 | |   | |   |   | |   |   |     | |   | |   |         | | | | |   | |     |   |   |     | |     | | | | |   |       | |       | | | |     | | | | | | |     |     | |       | |   | | | |   | | | | | |
 | |   | |   |   | |   |   |     | |   | |   |         | | | | |   | |     |   |   |     | |     | | | | |   |       | |       | | | |     | | | | | | |     |     | |       | |   | | +-------|-|-+ | |
 | |   | |   |   | |   |   |     | |   | |   |         | | | | |   | |     |   H   |     | |     | | | | |   |       | |       | | | |     | | | | | | |     |     | |       | |   | |   |   | | |   | |
 | |   | | +-|---|-----+   |     | |   | |   |         | | | | |   | |     |   |   |     +-|-------|---|-|-----------|-----------|-|---+   | | | | | | |     |     | |       | |   | |   |   | | |   | |
 | |   | | | |   | |       |     | |   | |   |         | | | | |   | |     |   |   |       |     | | | | |   |       | |       | | | | |   | | | | | | |     |     | |       | |   | |   |   | | |   | |
 | |   | | | |   | |       |     | |   | |   |         | | | | |   | |     |   |   |       |     | | | | |   | +-----|-|-------|-|-----|---|-----|-------------------|-------|-+   | |   |   | | |   | |
 | |   | | | |   | |       |     | |   | |   |         | | | | |   | |     |   |   |       |     | | | | |   | |     | |       | | | | |   | | | | | | |     |     | |       |     | |   |   | | |   | |
 | |   | | | |   | |       |     | |   | |   |         | | | | |   | |     |   |   |       |     | | | | |   | |     | |       | | | | |   | | | | | | |     |     +-|-----+ |     | |   |   | | |   | |
 | |   | | | |   | |       |     | |   | |   |         | | | | |   | |     |   |   |       |     | | | | |   | |     | |       | | | | |   | | | | | | |     |       |     | |     | |   |   | | |   | |
 | |   | | | |   | |       | +---|-|---|-|---|-----------|---|-----|-|---------|---|-------------|-|-----|-----|-------|-------|-------|---|---|-|-|-|-----------------------------------|-------------+
 | |   | | | |   | |       | |   | |   | |   |         | | | | |   | |     |   |   |       |     | | | | |   | |     | |       | | | | |   | | | | | | |     |       |     | |     | |   |   | | |   |
 | |   | | | |   | |       | |   | |   | |   |         | | | | |   | |     |   | +-|-------|---+ | | | | |   | |     | |       | | | | |   | | | | | | |     |       |     | | +-----|-+ |   | | |   |
 | |   | | | |   | |       | |   | |   | |   |         | | | | |   | |     |   | | |       |   | | | | | |   | |     | |       | | | | |   | | | | | | |     |       |     | | |   | | | |   | | |   |
 | |   | | | |   | | +-------|---|-------|---------------|-|---------|-----|---|-----------|---|-|-|-|-----------------------------|-------|-|---------+     |       |     | | |   | | | |   | | |   |
 | |   | | | |   | | |     | |   | |   | |   |         | | | | |   | |     |   | | |       |   | | | | | |   | |     | |       | | | | |   | | | | | |       |       |     | | |   | | | |   | | |   |
 | |   | | | |   | | |     | +-+ | |   | |   |     +---|-----|-----------------|-|-------+ |   | | | | | | +-|-------+ |       | | | | |   | | | | | |       |       |     | | |   | | | |   | | |   |
 | |   | | | |   | | |     |   | | |   | |   |     |   | | | | |   | |     |   | | |     | |   | | | | | | | | |       |       | | | | |   | | | | | |       |       |     | | |   | | | |   | | |   |
 | |   | | | |   | | |     |   | | |   | |   |     |   | | | | |   | |     |   | | |     | |   | | | | | | | | |       |       +---|---|-------|-|---|-----------------+   | | |   | +---+   | | |   |
 | |   | | | |   | | |     |   | | |   | |   |     |   | | | | |   | |     |   | | |     | |   | | | | | | | | |       |         | | | |   | | | | | |       |       | |   | | |   |   |     | | |   |
 | |   | | | |   | | |     |   | | |   | |   | +-------|-|-|-|-------|---------|-|-------------|-|---|-|-----|-|-------------------|-------|-|-------|-------------+ | |   | | |   |   |     | | |   |
 | |   | | | |   | | |     |   | | |   | |   | |   |   | | | | |   | |     |   | | |     | |   | | | | | | | | |       |         | | | |   | | | | | |       |     | | |   | | |   |   |     | | |   |
 | |   | | | |   | | |     |   | | +-----+   | |   |   | | | | |   | |     |   | +---------|-----+ | +-+ | | | |       |         | | | |   | | | | | |       |     | | |   | | |   |   |     | | |   |
 | |   | | | |   | | |     |   | |     |     | |   |   | | | | |   | |     |   |   |     | |   |   |     | | | |       |         | | | |   | | | | | |       |     | | |   | | |   |   |     | | |   |
 | |   | | | |   | | |     |   | |   +-|-----------|---|-|---|-------+ +-------|-----------+   |   |     | | | |       |         | | | |   | | | | | |       |     | | |   | | |   |   |     | | |   |
 | |   | | | |   | | |     |   | |   | |     | |   |   | | | | |   |   |   |   |   |     |     |   |     | | | |       |         | | | |   | | | | | |       |     | | |   | | |   |   |     | | |   |
 | |   | | | |   | | |     |   | |   | |     | |   |   | | | | |   |   |   |   |   |     |     | +-|-----+ | | |       |         | | | |   | | | | | |       |     | | |   | | |   |   |     | | |   |
 | |   | | | |   | | |     |   | |   | |     | |   |   | | | | |   |   |   |   |   |     |     | | |       | | |       |         | | | |   | | | | | |       |     | | |   | | |   |   |     | | |   |
 | |   | | | |   | | |     |   | |   | |     | |   |   | | | | |   |   |   |   |   |     |   +---|-|---------|-|---------------+ | | | |   | | | | | |       |     | | |   | | |   |   |     | | |   |
 | |   | | | |   | | |     |   | |   | |     | |   |   | | | | |   |   |   |   |   |     |   | | | |       | | |       |       | | | | |   | | | | | |       |     | | |   | | |   |   |     | | |   |
 | |   | | | |   | | |     |   | |   | | +---|---------|---|---------------|---|---|-----|---------|-------|---------------------|---|-------|-|-|-----+     |     | | |   | | |   |   |     | | |   |
 | |   | | | |   | | |     |   | |   | | |   | |   |   | | | | |   |   |   |   |   |     |   | | | |       | | |       |       | | | | |   | | | | | | |     |     | | |   | | |   |   |     | | |   |
 | |   | | +-|-+ | | |     |   | |   | | |   | |   |   | | | | |   |   |   |   |   |     |   | +-|---------|-------------------|-----------|---|-----|-------|-----|---------|-+   |   |     | | |   |
 | |   | |   | | | | |     |   | |   | | |   | |   |   | | | | |   |   |   |   |   |     |   |   | |       | | |       |       | | | | |   | | | | | | |     |     | | |   | |     |   |     | | |   |
 | |   | |   | | | | |     |   | |   | | |   | |   |   | | | | |   |   |   |   |   |     |   |   | |       | | |       |       | | | | |   | | | | | | |     |   +-----|-----+     |   |     | | |   |
 | |   | |   | | | | |     |   | |   | | |   | |   |   | | | | |   |   |   |   |   |     |   |   | |       | | |       |       | | | | |   | | | | | | |     |   | | | |   |       |   |     | | |   |
 | |   +-|---|-|---|-|-----|---|-|---|-|-+ +---|-+ |   | | | | |   |   +-------|-----+   |   |   | |       | | |       |       | | | | |   | | | | | | |     |   | | | |   |       |   |     | | |   |
 | |     |   | | | | |     |   | |   | |   | | | | |   | | | | |   |       |   |   | |   |   |   | |       | | |       |       | | | | |   | | | | | | |     |   | | | |   |       |   |     | | |   |
 | | +---+   | | | | |     |   | |   | |   | | | | |   | | | | |   |       |   |   | |   +---|-----|-------|-|-----------------|-|-|-|-|---|-|---|-|-|-|-------------------|-------|---|-----+ | |   |
 | | |       | | | | |     |   | |   | |   | | | | |   | | | | |   |       |   |   | |       |   | |       | | |       |       | | | | |   | | | | | | |     |   | | | |   |       |   |       | |   |
 | | | +-----|---+ | |     |   | |   | |   | | | | |   | | | | |   |       |   |   | |       |   | |       | | |       |       | | | | |   | | | | | | |     |   | | | |   |       |   |       | |   |
 | | | |     | |   | |     |   | |   | |   | | | | |   | | | | |   |       |   |   | |       |   | |       | | |       |       | | | | |   | | | | | | |     |   | | | |   |       |   |       | |   |
 | | | |     | |   | |     |   | |   | |   | | | | |   | | | | |   |       |   |   | |       |   | | +-------|---------|-------|-|-|-------|-----|-|-|-|---------|-----|-----+     |   |       | |   |
 | | | |     | |   | |     |   | |   | |   | | | | |   | | | | |   |       |   |   | |       |   | | |     | | |       |       | | | | |   | | | | | | |     |   | | | |   | |     |   |       | |   |
 | | | |     | |   | |     |   | |   | |   | | | | | +-|-+ | +-------------|---|---|---------|-------------|-|---------|-------|---|-|-|-------|-|-|---------|-------|-|---|-----------|-----+ | |   |
 | | | |     | |   | |     |   | |   | |   | | | | | | |   |   |   |       |   |   | |       |   | | |     | | |       |       | | | | |   | | | | | | |     |   | | | |   | |     |   |     | | |   |
 | | | | +-----|-----|---------|-+   | |   | | | | | | |   |   |   |       |   |   | |       |   | | |     | | |       |       | | | | |   | | | | | | |     |   | | | |   | |     |   | +-----+ |   |
 | | | | |   | |   | |     |   |     | |   | | | | | | |   |   |   |       |   |   | |       |   | | |     | | |       |       | | | | |   | | | | | | |     |   | | | |   | |     |   | |   |   |   |
 | | | | |   | |   | |     |   |     | |   | | | | | | |   |   |   |       |   |   | |       |   | | |     | | |       |       | | | | |   | | | | | | |     |   | | | |   | |     |   | |   |   |   |
 | | | | |   | |   | |     |   |     | |   | | | | | | |   |   |   |       |   |   | |       |   | | |     | | |       |       | | | | |   | | | | | | |     |   | | | |   | |     |   | |   |   |   |
 | | | | |   | |   | |     |   |     | |   | | | | | | +-------|-----------|-------|-|-------|-----+ |     | | |       |       +---|-|-|---|-|-|-+ | | |     |   | | | |   | |     |   | |   |   |   |
 | | | | |   | |   | |     |   |     S |   | | | | | |     |   |   |       |   |   | |       |   |   |     | | |       |         | | | |   | | |   | | |     |   | | | |   | |     |   | |   |   |   |
 | | | | |   | |   | |     |   |     | |   | | | | | | +---|-------|---------------------------------|---------|-----------------|---|-|---|-|---+ | | |   +---------|-----|---------+ | |   |   | +-|-+
 | | | | |   | |   | |     |   |     | |   | | | | | | |   |   |   |       |   |   | |       |   |   |     | | |       |         | | | |   | | | | | | |   | |   | | | |   | |     | | | |   |   | | | |
 +-----|-|---|-|---|-----------|-----|-|---|-----|---------|---+   |       |   |   | |   +-------|-+ |     | | |       |         | | | |   | | | | | | |   | |   | | | |   | |     | | | |   |   | | | |
   | | | |   | |   | |     |   |     | |   | | | | | | |   |       |       |   |   | |   |   |   | | |     | | |       |         | | | |   | | | | | | |   | |   | | | |   | |     | | | |   |   | | | |
   | | | |   | | +---|-----|---------|-----|---|-|-|-|-----|-------|-------|---|-----|-------+ +-|-|-------|-|---------------------|-|-|-------------------|-|-+ | | +-|---+ |     | | | |   |   | | | |
   | | | |   | | | | |     |   |     | |   | | | | | | |   |       |       |   |   | |   |     | | | |     | | |       |         | | | |   | | | | | | |   | | | | |   |     |     | | | |   |   | | | |
 +-------------|-|-|-|-----|---------|-----|-|-----|-|---------------------|---|-----|---------|-|-|-|-------|---------+         | | | |   | | | | | | |   | | | | |   |     |     | | | |   |   | | | |
 | | | | |   | | | | |     |   |     | |   | | | | | | |   |       |       |   |   | |   |     | | | |     | | |                 | | | |   | | | | | | |   | | | | |   |     |     | | | |   |   | | | |
 | | +-|-----|-|---|-|-----|---------------|---|---|---|---|-------|-------|-------|-----+     | | | |     | | |                 | | | |   | | +---|-+ |   | | | | |   |     |     | | | |   | +-+ | | |
 | |   | |   | | | | |     |   |     | |   | | | | | | |   |       |       |   |   | |         | | | |     | | |                 | | | |   | |   | |   |   | | | | |   |     |     | | | |   | |   | | |
 | | +---|---|-|-----------|---|-------|-------|---+ | |   |       |   +-----------------------|---|-------|---+ +---------------|-----+   | |   | |   |   | | | | |   |     |     | | | |   | |   | | |
 | | | | |   | | | | |     |   |     | |   | | | |   | |   |       |   |   |   |   | |         | | | |     | |   |               | | |     | |   | |   |   | | | | |   |     |     | | | |   | |   | | |
 | | | +---+ | +-|---|-+ +-----|-----|-+ +-+ | | |   | |   |       |   |   |   |   | |         | | | |     | |   |               | | |     | |   | |   |   | | | | |   |     |     | | | |   | |   | | |
 | | |   | | |   | | | | | |   |     |   |   | | |   | |   |       |   |   |   |   | |         | | | |     | |   |               | | |     | |   | |   |   | | | | |   |     |     | | | |   | |   | | |
 | | | +-|-----------|-|---|---+     | +-------|-+   | |   |       |   |   |   |   | |         +---|-+     | |   |               | | |   +-|-|-----|-----+ | | | | +---+     | +-+ | +-+ |   | |   | | |
 | | | | | | |   | | | | | |         | | |   | |     | |   |       |   |   |   |   | |           | |       | |   |               | | |   | | |   | |   | | | | | |           | | | |     |   | |   | | |
 | +-----|-|V------|-|---|-|---------|-|-------|-----|-----------------|-------------------------|---------|-----|---------------------------+   | |   | | +-|-+ |           | | | |     |   | |   | | |
 |   | | | | |   | | | | | |         | | |   | |     | |   |       |   |   |   |   | |           | |       | |   |               | | |   | |     | |   | |   |   |           | | | |     |   | |   | | |
 |   | +-|-|-----|-|-|-|---------------------|-|-------|---------------|---|-------|-------------|---------|-|-----------+       | | |   | |     | |   | |   |   |           | | | |     |   | |   | | |
 |   |   | | |   | | | | | |         | | |   | |     | |   |       |   |   |   |   | |           | |       | |   |       |       | | |   | |     | |   | |   |   |           | | | |     |   | |   | | |
 |   | +-----+   | | | | | |         +---|-----------|-|---------------|-------|---|-|-----------------------|---|-----------------|-----|-------|-|---|-|---|---+           | | | |     |   | |   | | |
 |   | | | |     | | | | | |           | |   | |     | |   |       |   |   |   |   | |           | |       | |   |       |       | | |   | |     | |   | |   |               | | | |     |   | |   | | |
 |   | +---------|-|---|-|-|-----------------|-|-------------------|-------|---|-------------------|---------|---------------------|-|-----|-------|---|-|---|-------------------|-|-----|---|-|-----+ |
 |   |   | |     | | | | | |           | |   | |     | |   |       |   |   |   |   | |           | |       | |   |       |       | | |   | |     | |   | |   |               | | | |     |   | |   |   |
 | +-|-----|-----+ +---|---|-----------------|---+   | |   |       |   |   |   |   | |           | |       | |   +-----------+   | | |   | |     | |   | |   |               +-|---|-----|-----+   |   |
 | | |   | |         | | | |           | |   | | |   | |   |       |   |   |   |   | |           | |       | |           |   |   | | |   | |     | |   | |   |                 | | |     |   |     |   |
 +-|-|-----|---------|-|-+ |           +-----|-|-+   | |   |       |   |   |   |   | |           | |       | |   +-----------|---+ | |   | |     | |   | |   |                 | | |     |   |     |   |
   | |   | |         | |   |             |   | |     | |   |       |   |   |   |   | |           | |       | |   |       |   |     | |   | |     | |   | |   |                 | | |     |   |     |   |
 +---------|---------|-|-----------------|-+ | |     | +---|-------|---|---|---|---------------+ | |       | |   |     +-|-------+ | |   | |     | |   | |   +---------------------|-+   |   +-----+   |
 | | |   | |         | |   |             | | | |     |     |       |   |   |   |   | |         | | |       | |   |     | |   |   | | |   | |     | |   | |                     | | | |   |             |
 | | | +---|---------+ +-+ |             | | | | +---------|---------------+   | +-|---------------|-------|-----|---------------|-|-----|-------|-------|---------------------|-|---+   |             |
 | | | | | |             | |             | | | | |   |     |       |   |       | | | |         | | |       | |   |     | |   |   | | |   | |     | |   | |                     | | |     |             |
 | | | | | |             | |             | | +---+   |     |   +---|-----------|---|-----------|-----------|-|---------|-|-----------|-----------|-|---|-|-------------------------|-----|-------------+
 | | | | | |             | |             | |   |     |     |   |   |   |       | | | |         | | |       | |   |     | |   |   | | |   | |     | |   | |                     | | |     |
 | | | | | |             | |     +-------|-|-+ |     |     |   |   |   |       | | | |         | | | +-----------|-----+ |   +---+ | |   | |     | |   | +---------------------+ +-------|-------+
 | | | | | |             | |     |       | | | |     |     |   |   |   |       | | | |         | | | |     | |   |       |         | |   | |     | |   |                           |     |       |
 | | | | | |         +-----|-----|-+     | | +-|-----------|---|-----------------|---+         | | | +-----+ |   +-------|-----------+   | |     | |   |             +-------------|-------------+
 | | | | | |         |   | |     | |     | |   |     |     |   |   |   |       | | |           | | |         |           |         |     | |     | |   |             |             |     |
 | | | | | |         |   | |     | |     | |   | +---------|---|---|---|-------|-|-|-----------|-|-|---------|-------------------+ | +---|-------------+             +-------------|-----+
 | | | | | |         |   | |     | |     | |   | |   |     |   |   |   |       | | |           | | |         |           |       | | |   | |     | |                               |
 | | | | | |         |   | |     | +-----------|-----|-----------+ |   | +-----|-|-|-------------------------|-----------+     +-|-|-|-------------+                               |
 | | | | | |         |   | |     |       | |   | |   |     |   | | |   | |     | | |           | | |         |                 | | | |   | |     |                                 |
 | | +---------------------|-----|-------|-|---------|-----|-----------|-|-----|---|-+       +-------+       |                 +-|-|-+   | |     | +---------------------------------+
 | |   | | |         |   | |     |       | |   | |   |     |   | | |   | |     | | | |       | | | | |       |                   | |     | |     | |                               | |
 | |   +-|-|---------|---|-------|---------|---|-|---------------|-------|---------|---------|-|-|-|---------|---------------------|-------|---------+                             | |             +-+
 | |     | |         |   | |     |       | |   | |   |     |   | | |   | |     | | | |       | | | | |       |                   | |     | |     | | |                             | |             | |
 | |     | |         |   | |     +-------|-----|-----------|---|---|---+ |     | | | |       | +-+ +---------|---------------+   | |     | |     | | |                             | |             | |
 | |     | |         |   | |             | |   | |   |     |   | | |     |     | | | |       |       |       |               |   | |     | |     | | |                             | |             | |
 | | +---+ |         |   | |             | |   | |   |     |   | | |   +---------|-|-|-------|---------+     |               |   +---------|-----+ +-+                             | |             | |
 | | |     |         |   | |             | |   | |   |     |   | | |   | |     | | | |       |       | |     |               |     |     | |                                       | |             | |
 | | |     |         |   | |   +---------|-+   | |   |     |   | +-----+ |     +-----|-------+       +-+     +---------------+     |     | |                                       | |             | |
 | | |     |         |   | |   |         |     | |   |     |   |   |     |       | | |                                             |     | |                                       | |             | |
 | | |     |         |   | |   +---------|-------|---------|---|---|-----|-----------|---------------------------------------------|-------+   +-------------------------------------|---------------+
 | | |     |         |   | |             |     | |   |     |   |   |     |       | | |                                             |     |     |                                   | |             |
 | | |     +---------+   | +-------------|-----------|---------|---|-------------|-------------------------------------------------+     |     |                                   | |             |
 | | |                   |               |     | |   |     |   |   |     |       | | |                                                   |     |                                   | |             |
 | | |                   |     +---------+ +---------|---+ +---|---------+       +-+ +---------------------------------------------+     |     |                                   | |             |
 | | |                   |     |           |   | |   |   |     |   |                                                               |     |     |                                   | |             |
 +-+ +-------------------------|-----------+ +-+ +---|---+     |   +---------------------------------------------------------------+     +-----+                                   | +-------------+
                         |     |             |       |         |                                                                                                                   |
                         +-----+             +-------+         +--------------------------------------------B----------------------------------------------------------------------+
                                                                                                                                                                                                         `;
let test = `
     |
     |  +--+
     A  |  C
 F---|----E|--+
     |  |  |  D
     +B-+  +--+ `

function getOrder(data) {
  let letters = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];
  let poses = letters.concat();
  poses.push('-');
  poses.push('|');
  map = data.split('\n').map(current => current.split(''));
  map.shift();
  let x = map[0].indexOf('|');
  let y = 0;
  // 0: Up, 1: Right, 2: Down, 3: Left
  let dir = 2;
  let ans = '';
  while (true) {
    switch (dir) {
      case 0:
        y--;
        break;
      case 1:
        x++;
        break;
      case 2:
        y++;
        break;
      case 3:
        x--;
        break;
    }
    if (letters.includes(map[y][x])) {
      ans += map[y][x];
    } else if (map[y][x] === '+') {
      switch (dir) {
        case 0:
        case 2:
          if (poses.includes(map[y][x-1])) {
            dir = 3;
          } else if (poses.includes(map[y][x+1])) {
            dir = 1;
          } else {
            return ans;
          }
          break;

        case 1:
        case 3:
          if (poses.includes(map[y-1][x])) {
            dir = 0;
          } else if (poses.includes(map[y+1][x])) {
            dir = 2;
          } else {
            return ans;
          }
          break;

      }
    } else if (map[y][x] === ' ') {
      return ans;
    }
  }
}



function getSteps(data) {
  let letters = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];
  let poses = letters.concat();
  poses.push('-');
  poses.push('|');
  map = data.split('\n').map(current => current.split(''));
  map.shift();
  let x = map[0].indexOf('|');
  let y = 0;
  // 0: Up, 1: Right, 2: Down, 3: Left
  let dir = 2;
  let counter = 1;
  while (true) {
    switch (dir) {
      case 0:
        y--;
        break;
      case 1:
        x++;
        break;
      case 2:
        y++;
        break;
      case 3:
        x--;
        break;
    }
    if (map[y][x] === '+') {
      switch (dir) {
        case 0:
        case 2:
          if (poses.includes(map[y][x-1])) {
            dir = 3;
          } else if (poses.includes(map[y][x+1])) {
            dir = 1;
          } else {
            return counter;
          }
          break;

        case 1:
        case 3:
          if (poses.includes(map[y-1][x])) {
            dir = 0;
          } else if (poses.includes(map[y+1][x])) {
            dir = 2;
          } else {
            return counter;
          }
          break;

      }
    } else if (map[y][x] === ' ') {
      return counter;
    }
    counter++;
  }
}




console.log(getOrder(input));
console.log(getSteps(input));
